language: node_js

node_js: lts/*

services:
  - docker

before_install:
  - docker pull node:alpine
  - docker pull postgres
  - wget -qO- https://toolbelt.heroku.com/install.sh | sh

jobs:
  include:
    - stage: test
    - script: docker-compose -f docker-compose.test.yml up --exit-code-from sut
    - stage: deploy
    - script: bash ./deploy.sh
